@import play.mvc.Http
@import views.html.helper.CSRF
@(destinationsList: List[Destination], currentUser: Profile, isPublic: Boolean, pagination: PaginationHelper, followedDestinationIds: List[Integer],
        usersPhotos: List[Photo], destinationForm: Form[Destination], destination: RoutedObject[Destination],
        requestForm: Form[DestinationRequest], countries: List[String], searchForm: Form[DestinationSearchFormData],searchVal: String)(implicit request: Http.Request, messages: play.i18n.Messages)

@import models.Destination; var toViewDest = new Destination()


<!DOCTYPE html>
<html>
    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/bootstrap/bootstrap-select.css")">
    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/bootstrap/bootstrap.css")">
    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/bootstrap/dataTables.bootstrap4.css")">


    <script src="@routes.Assets.at("javascripts/jquery-3.3.1.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("javascripts/bootstrap.bundle.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("javascripts/bootstrap-select.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("javascripts/jquery.dataTables.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("javascripts/dataTables.bootstrap4.js")" type="text/javascript"></script>


    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/sidebar.css")">
    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/general.css")">
    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/destinations.css")">
    <head>
        <link rel="shortcut icon" type="image/*" href="@routes.Assets.at("images/logo.ico")"/>
        <title>SoundBound | Destinations</title>
    </head>

    <body>

        <div class="d-flex toggled" id="wrapper">
                <!-- Sidebar -->
            <div id="sidebar-wrapper">
                <h2 class="sidebar-heading">SoundBound </h2>
                <div class="list-group list-group-flush">
                    <a href="@routes.EventsController.show(0)" class="list-group-item list-group-item-action bg-transparent">
                        <img class="sidebar-icon" src="@routes.Assets.at("images/event-icon.png")"/>
                        Events
                    </a>
                    <a href="@routes.ArtistController.show()" class="list-group-item list-group-item-action bg-transparent"><img class="sidebar-icon" src="@routes.Assets.at("images/artist-icon.png")" alt="Not Found"/>
                        Artists
                    </a>
                    <a href="@routes.ProfileController.show()" class="list-group-item list-group-item-action bg-transparent"><img class="sidebar-icon" src="@routes.Assets.at("images/profile-icon.png")" alt="Not Found"/>
                        Profile
                    </a>
                    <a style="color: #d74961; background-color: #ede1d1 !important" href="@routes.DestinationsController.show(false, 0)" class="list-group-item list-group-item-action bg-transparent"><img class="sidebar-icon" src="@routes.Assets.at("images/destination-icon.png")" alt="Not Found"/>
                        Destinations
                    </a>
                    <a href="@routes.TripsController.show(0)" class="list-group-item list-group-item-action bg-transparent"><img class="sidebar-icon" src="@routes.Assets.at("images/trips-icon.png")" alt="Not Found"/>
                        Trips
                    </a>
                    <a href="@routes.TravellersController.show(0)" class="list-group-item list-group-item-action bg-transparent"><img class="sidebar-icon" src="@routes.Assets.at("images/traveller-icon.png")" alt="Not Found"/>
                        Travellers
                    </a>
                    <a href="@routes.TreasureHuntController.show(0)" class="list-group-item list-group-item-action bg-transparent"><img class="sidebar-icon" src="@routes.Assets.at("images/treasure-hunt-icon.png")" alt="Not Found"/>
                        Treasure Hunt
                    </a>
                    @if(currentUser.hasRole("global_admin") || currentUser.hasRole("admin")) {
                        <a href="@routes.AdminController.showAdmins(0)" class="list-group-item list-group-item-action bg-transparent"><img class="sidebar-icon" src="@routes.Assets.at("images/admin-icon.png")" alt="Not Found"/>
                            Admin</a>
                    }
                    <a href="@routes.LoginController.show()" class="list-group-item list-group-item-action bg-transparent"><img class="sidebar-icon" src="@routes.Assets.at("images/logout-icon.png")" alt="Not Found"/>
                        Logout
                    </a>
                </div>
            </div>
                <!-- /#sidebar-wrapper -->

                <!-- Page Content -->
            <div id="page-content-wrapper">

                <nav class="navbar navbar-expand-lg navbar-light topbar-dark">
                    <h3 class="expand-icon toggleButton" id="menu-toggle" ><img class="toggleButton" id="menuIcon" src="@routes.Assets.at("images/burger-menu.png")" alt="Not Found"/></h3>
                    <div id="pageTitle">
                        <h2 class="text-center">Destinations</h2>
                    </div>
                </nav>

                @if(request.flash.getOptional("success").isPresent) {
                    <div class="alert alert-success">
                    @request.flash.getOptional("success").get()
                    </div>
                }

                @if(request.flash.getOptional("failure").isPresent) {
                    <div class="alert alert-warning">
                    @request.flash.getOptional("failure").get()
                    </div>
                }

                @if(request.flash.getOptional("error").isPresent) {
                    <div class="alert alert-warning">
                    @request.flash.getOptional("error").get()
                    </div>
                }

                <div class="container-fluid">
                    <div class="row">
                        <div class="col d-flex justify-content-center">
                            <button id="destButton" type="button" class="btn btn-primary" data-toggle="modal" data-target="#createDestModal" href="">
                                Create Destination</button>
                        </div>
                    </div>


                    <div class="row">
                        <div class="col">
                            <div id="dest-table-card" class="card-large dest-table table-hover">
                                <div class="row justify-content-center">
                                    @if(searchVal != "") {
                                        <a style="margin-top: 10px;" href="@routes.DestinationsController.show(isPublic, 0)">
                                            <button class="btn btn-secondary" onclick="">Clear</button></a>
                                    }
                                    <div class="col">
                                        @helper.form(routes.DestinationsController.search(0)) {
                                            @CSRF.formField
                                            <input type="hidden" id="is1Public" name="isPublic" value="@isPublic">
                                            <input type="search" id="searchName" placeholder="Search" name="name" value="@searchVal">
                                            <button class="btn btn-primary" id="searchButton">Search</button>
                                        }
                                    </div>
                                </div>

                                <div class="row">
                                    <table id="destTable">
                                        <thead>
                                            <tr><th>Destination</th>
                                                <th>Type</th>
                                                <th>Country</th>
                                                <th>Edit</th>
                                                <th>Delete</th>
                                        </thead>

                                        @for(destination <- destinationsList) {
                                            <tr onclick="setSelectedDestination(@destination.getDestinationId, this)">
                                                <td>@destination.getName()</td>
                                                <td>@destination.getType()</td>
                                                <td>@destination.getCountry()</td>

                                                @if(destination.getProfileId == currentUser.getProfileId || currentUser.hasRole("admin")) {

                                                    <td>
                                                        <a href="@routes.DestinationsController.showDestinationEdit(destination.getDestinationId, isPublic)">
                                                            <button class="button-editDestinations btn btn-outline-primary" style="height: 4vh">
                                                                Edit</button>
                                                        </a>
                                                    </td>

                                                    <td>
                                                        <button type="submit" class="btn btn-danger" style="height: 4vh"
                                                        onclick="fillDeleteValues('@routes.DestinationsController.delete(destination.getDestinationId())')">
                                                            Delete
                                                        </button>
                                                    </td>
                                                } else {
                                                    @if(followedDestinationIds contains destination.getDestinationId()) {
                                                        @helper.form(routes.DestinationsController.unfollow(currentUser.getProfileId, destination.getDestinationId(), isPublic)) {
                                                            @CSRF.formField
                                                            <td> <button type="submit" class="button-editDestinations btn btn-primary" style="height: 4vh">
                                                                Unfollow</button></td>
                                                        }
                                                    } else {
                                                        @helper.form(routes.DestinationsController.follow(currentUser.getProfileId, destination.getDestinationId(), isPublic)) {
                                                            @CSRF.formField
                                                            <td> <button type="submit" class="button-editDestinations btn btn-outline-secondary" style="height: 4vh">
                                                                Follow</button></td>
                                                        }
                                                    }
                                                    <td></td>
                                                }
                                            </tr>
                                        }
                                    </table>
                                </div>

                                <div class="col" id="pagination-links">
                                    <ul class="pagination">
                                        @if(searchVal != "") {
                                            @if(pagination.isPreviousEnabled) {
                                                @helper.form(routes.DestinationsController.search(0)) {
                                                    <input type="hidden" id="is2Public" value="@isPublic">
                                                    <input type="hidden" id="searchName" placeholder="Search" name="name" value="@searchVal">
                                                    <button type="hidden" id="startSearchHidden">Search</button>
                                                        <li class="page-item"><a class="page-link" id="startLinkSearch">
                                                            Start</a></li>
                                                }
                                                @helper.form(routes.DestinationsController.search(pagination.getNext)) {
                                                    <input type="hidden" id="is3Public" value="@isPublic">
                                                    <input type="hidden" id="searchName" placeholder="Search" name="name" value="@searchVal">
                                                    <button type="hidden" id="prevSearchHidden">Search</button>
                                                    <li class="page-item"><a class="page-link" id="prevLinkSearch">
                                                        Previous</a></li>
                                                }
                                            } else {
                                                <li class="page-item disabled"><a class="page-link disabled" id="prevLink">
                                                    Start</a></li>
                                                <li class="page-item disbaled"><a class="page-link disabled" id="prevLink">
                                                    Previous</a></li>
                                            }

                                            @helper.form(routes.DestinationsController.search(pagination.getNext)) {
                                                <input type="hidden" id="is4Public" value="@isPublic">
                                                <input type="hidden" id="searchName" placeholder="Search" name="name" value="@searchVal">
                                                <button type="hidden" id="nextSearchHidden">Search</button>
                                                <li class="page-item">
                                                @if(pagination.isNextEnabled) {
                                                    <a class="page-link" id="nextLinkSearch">
                                                        Next</a>
                                                } else {
                                                    <a class="page-link disabled" id="nextLink">
                                                        Next</a>
                                                }
                                                </li>
                                            }
                                        } else {

                                            @if(pagination.isPreviousEnabled) {
                                                <li class="page-item"><a class="page-link" id="startLink" href="/destinations/show/@isPublic/0">
                                                    Start</a></li>
                                                <li class="page-item"><a class="page-link" id="prevLink" href="/destinations/show/@isPublic/@pagination.getPrevious">
                                                    Previous</a></li>
                                            } else {
                                                <li class="page-item disabled"><a class="page-link disabled" id="prevLink" href="/destinations/show/@isPublic/0">
                                                    Start</a></li>
                                                <li class="page-item disabled"><a class="page-link disabled" id="prevLink" href="/destinations/show/@isPublic/@pagination.getPrevious">
                                                    Previous</a></li>
                                            }

                                            @if(pagination.isNextEnabled) {
                                                <li class="page-item"><a class="page-link" id="nextLink" href="/destinations/show/@isPublic/@pagination.getNext">
                                                    Next</a></li>
                                            } else {
                                                <li class="page-item disabled"><a class="page-link disabled" id="nextLink" href="/destinations/show/@isPublic/@pagination.getNext">
                                                    Next</a></li>
                                            }
                                        }

                                    </ul>
                                </div>
                                <div id="btn-row" class="row justify-content-center">
                                @if(!isPublic) {
                                    <input type="checkbox" id="destToggle" onchange="togglePublic()">
                                    <a>View Public Destinations</a>
                                } else {
                                    <input type="checkbox" id="destToggle" checked onchange="togglePublic()">
                                    <a>View Public Destinations</a>
                                }
                                </div>
                            </div>

                            <div id="table-card" class="card-large">
                                <div class="row" id="headerRow">
                                    <ul class="nav nav-tabs" id="destinationTabs">
                                        <li class="active"><a data-toggle="tab" href="#detailsTab" id="detailsTabLink">
                                            Details</a></li>
                                        <li><a data-toggle="tab" href="#myPhotosTab" id="myPhotosTabLink">
                                            My Photos</a></li>
                                        <li><a data-toggle="tab" href="#worldPhotosTab" id="worldPhotosTabLink">
                                            Public Photos</a></li>
                                    </ul>
                                </div>
                                <div class="tab-content" id="destinationTabsContent">

                                    <div id="detailsTab" class="tab-pane fade in active show">
                                        <div class="container">

                                            <div id="nameRow" class="row justify-content-center">
                                                <div id="nameVal" class="col">
                                                    <a></a>
                                                </div>

                                            </div>

                                            <div id="typeRow" class="row justify-content-center">
                                                <div id="typeVal" class="col">
                                                    <a></a>
                                                </div>
                                            </div>

                                            <div id="countryRow" class="row justify-content-center">
                                                <div id="countryVal" class="col">
                                                    <a></a>
                                                </div>
                                            </div>

                                            <div id="districtRow" class="row justify-content-center">
                                                <div id="districtVal" class="col">
                                                    <a></a>
                                                </div>
                                            </div>

                                            <div id="latRow" class="row justify-content-center">
                                                <div id="latVal" class="col">
                                                    <a></a>
                                                </div>
                                            </div>

                                            <div id="lngRow" class="row justify-content-center">
                                                <div id="lngVal" class="col">
                                                    <a></a>
                                                </div>
                                            </div>

                                            <div id="publicRow" class="row justify-content-center">
                                                <div id="publicVal" class="col">
                                                    <a></a>
                                                </div>
                                            </div>

                                            <div id="travellerTypes" class="row justify-content-center">
                                                <div id="travellerTypesVal" class="col-md-4">
                                                    <a></a>
                                                </div>
                                            </div>

                                            <div>
                                                <button class="btn btn-primary" id="suggestEditButton" data-toggle="modal" hidden
                                                data-target="#suggestEditModal" onclick="setTravellerTypesToRemove()">
                                                    Suggest Edit</button>
                                            </div>

                                        </div>
                                    </div>
                                    <div id="myPhotosTab" class="tab-pane fade">
                                        <button class="btn btn-primary" style="right" data-toggle="modal"
                                        data-target="#linkDestinationPhotoModal">Link Photo</button>

                                        <div class="col">
                                            <div class="row" id="userPhotos"></div>
                                        </div>
                                    </div>
                                    <div id="worldPhotosTab" class="tab-pane fade">
                                        <div class="container" id="worldPhotos">
                                            <a></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div id="map-table-card" class="card-large">
                                <div id="destinationsMap"></div>
                                <div id="legend"><h4>Legend</h4></div>
                            </div>
                        </div>
                    </div>


                    <div class="modal fade" id="linkDestinationPhotoModal">
                        <div class="modal-dialog modal-dialog-centered modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h2 class="modal-title">Link a Picture to this destination</h2>
                                </div>
                                <div class="modal-body">
                                    <div id="photosCard" class="card-large lower-card">
                                        <div class="row" id="photoUpdate">
                                            <div></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="changeProfilePictureButton btn btn-danger" data-dismiss="modal" style="width: 10vw;
                                        float: right" data-toggle="modal" data-target="#changeProfilePicture">Close</button>
                                </div>
                            </div>

                        </div>

                    </div>

                    <div class="modal fade" id="createDestModal">
                        <div class="modal-dialog modal-xl modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h2 class="modal-title">Create Destination</h2>
                                </div>
                                @helper.form(routes.DestinationsController.saveDestination()) {
                                    @CSRF.formField
                                    <div class="modal-body">
                                        <div class="row">
                                            <div class="col-4">
                                                <div class="row entry-row">
                                                    <div class="form-group" id="holder">
                                                        <small id="label">Name*</small>
                                                        <input type="text" id="name" placeholder="Name" name="name" required oninvalid="this.setCustomValidity('Name required')" oninput="setCustomValidity('')">
                                                    </div>
                                                </div>
                                                <div class="row entry-row">
                                                    <div class="form-group" id="holder">
                                                        <small id="label">Type*</small>
                                                        <input type="text" id="type" placeholder="Type" name="type" required oninvalid="this.setCustomValidity('Type required')" oninput="setCustomValidity('')">
                                                    </div>
                                                </div>
                                                <div class="row entry-row">
                                                    <div class="form-group" id="holder">
                                                        <small id="label">District</small>
                                                        <input type="text" id="district" placeholder="District" name="district">
                                                    </div>
                                                </div>
                                                <div class="row entry-row">
                                                    <div class="hidden-div-edit">
                                                        <input type="text" id="country" name="country" placeholder="Country" class="hidden-field" >
                                                    </div>
                                                    <select class="selectpicker" data-live-search="true" title="Country" id="countriesDropdown" data-width="80%" required oninvalid="this.setCustomValidity('Country required')" onchange="this.setCustomValidity('')">
                                                    @for(nation <- countries) {
                                                        <option value="@nation">@nation</option>
                                                    }
                                                    </select>
                                                </div>
                                                <div class="row entry-row">
                                                    <div class="form-group" id="holder">
                                                        <small id="label">Latitude</small>
                                                        <input type="number" step="0.0000000001" id="latitude" class="createLat" value=0.0 name="latitude" onkeyup="moveCreateMarker()">
                                                    </div>
                                                </div>
                                                <div class="row entry-row">
                                                    <div class="form-group" id="holder">
                                                        <small id="label">Longitude</small>
                                                        <input type="number" step="0.0000000001" id="longitude" class=createLng value=0.0 name="longitude" onkeyup="moveCreateMarker()">
                                                    </div>
                                                </div>
                                                <div class="row entry-row">
                                                    <div class="hidden-div-edit">
                                                        <input type="text" id="travellerTypesStringDest" name="travellerTypesStringDest" class="hidden-field typesField">
                                                    </div>
                                                    <select class="selectpicker" multiple title="Traveller Type" id="typeDropdown" data-width="80%">
                                                        <option value="ThrillSeeker">ThrillSeeker</option>
                                                        <option value="Backpacker">Backpacker</option>
                                                        <option value="Gap Year">Gap Year</option>
                                                        <option value="Groupie">Groupie</option>
                                                        <option value="Frequent Weekender">Frequent Weekender</option>
                                                        <option value="Functional/business Traveller">
                                                            Functional/business Traveller</option>
                                                        <option value="Holidaymaker">Holidaymaker</option>
                                                    </select>
                                                </div>
                                                <div class="row entry-row">
                                                    <div class="col">
                                                        <label id="label" for="visible">Make Public</label>
                                                    </div>
                                                    <div class="col">
                                                        <input type="checkbox" id="visible" name="visible" value="Public" class="check-box">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col">
                                                <div id="createMap"></div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">
                                            Cancel</button>
                                        <button type="submit" id="createButton" class="btn btn-primary" onclick="fillVals()">
                                            Save</button>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                    @if(destination.isEdit && destination.getObject != null) {
                        <script type="text/javascript">
                                $(window).on('load', function () {
                                    $('#editDestModal').modal('show');
                                });
                        </script>
                        <div class="modal" id="editModal">
                            <div class="modal-dialog modal-xl">
                                <div class="modal-content">
                                        <!-- header -->
                                    <div class="modal-header">
                                        <h2 class="modal-title">Edit Destination</h2>
                                    </div>
                                        <!-- body -->
                                    @helper.form(routes.DestinationsController.update(destination.getObject.getDestinationId)) {
                                        @CSRF.formField
                                        <div class="modal-body">
                                        <div class="row">
                                                <div class="col-4">
                                                    <div class="col">
                                                        <div class="row">
                                                            <label>Name</label>
                                                        </div>
                                                        <div class="row">
                                                            <input type="text" id="name" placeholder="Name" name="name" value="@destination.getObject.getName" required oninvalid="this.setCustomValidity('Name required')" oninput="setCustomValidity('')">
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="row">
                                                            <label for="type">Type</label>
                                                        </div>
                                                        <div class="row">
                                                            <input type="text" id="type" placeholder="Type" name="type" value="@destination.getObject.getType" required oninvalid="this.setCustomValidity('Type required')" oninput="setCustomValidity('')">
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="row">
                                                            <label>District</label>
                                                        </div>
                                                        <div class="row">
                                                            <input type="text" id="district" placeholder="District" name="district" value="@destination.getObject.getDistrict">
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="row">
                                                            <label>Country</label>
                                                        </div>
                                                        <div class="row">
                                                            <div class="hidden-div-edit">
                                                                <input type="text" id="countryEdit" name="country" placeholder="Country" value="@destination.getObject.getCountry" class="hidden-field" required oninvalid="this.setCustomValidity('Country required')" oninput="setCustomValidity('')">
                                                            </div>
                                                            <select class="selectpicker" data-live-search="true" title="Country" id="countriesDropdownEdit" data-width="75%">
                                                            @for(nation <- countries) {
                                                                @if(destination.getObject.getCountry.equals(nation)) {
                                                                    <option value="@nation" selected>@nation</option>
                                                                } else {
                                                                    <option value="@nation">@nation</option>
                                                                }
                                                            }
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="row">
                                                            <label>Latitude</label>
                                                        </div>
                                                        <div class="row">
                                                            <input type="number" step="0.0000000001" id="latitude" name="latitude" class="editLat" value="@destination.getObject.getLatitude" onkeyup="moveEditMarker()">
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="row">
                                                            <label>Longitude</label>
                                                        </div>
                                                        <div class="row">
                                                            <input type="number" step="0.0000000001" id="longitude" name="longitude" class="editLng" value="@destination.getObject.getLongitude" onkeyup="moveEditMarker()">
                                                        </div>

                                                    </div>
                                                    <div class="col">
                                                        <div class="row">
                                                            <label>Traveller Types</label>
                                                        </div>
                                                        <div class="row">
                                                            <div class="hidden-div-edit">
                                                                <input type="text" id="travellerTypesForm" name="travellerTypesStringDestEdit" class="hidden-field typesField" value="@destination.getObject.getTravellerTypesString">
                                                            </div>
                                                            <select class="selectpicker" multiple title="Traveller Type" id="typeDropdownEdit" data-width="75%">
                                                                @if(destination.getObject.getTravellerTypesList.contains("ThrillSeeker")) {
                                                                    <option value="ThrillSeeker" selected>ThrillSeeker</option>
                                                                } else {
                                                                    <option value="ThrillSeeker">ThrillSeeker</option>
                                                                }

                                                                @if(destination.getObject.getTravellerTypesList.contains("Backpacker")) {
                                                                    <option value="Backpacker" selected>Backpacker</option>
                                                                } else {
                                                                    <option value="Backpacker">Backpacker</option>
                                                                }

                                                                @if(destination.getObject.getTravellerTypesList.contains("Gap Year")) {
                                                                    <option value="Gap Year" selected>Gap Year</option>
                                                                } else {
                                                                    <option value="Gap Year">Gap Year</option>
                                                                }

                                                                @if(destination.getObject.getTravellerTypesList.contains("Groupie")) {
                                                                    <option value="Groupie" selected>Groupie</option>
                                                                } else {
                                                                    <option value="Groupie">Groupie</option>
                                                                }

                                                                @if(destination.getObject.getTravellerTypesList.contains("Frequent Weekender")) {
                                                                    <option value="Frequent Weekender" selected>
                                                                        Frequent Weekender</option>
                                                                } else {
                                                                    <option value="Frequent Weekender">Frequent Weekender</option>
                                                                }

                                                                @if(destination.getObject.getTravellerTypesList.contains("Functional/business Traveller")) {
                                                                    <option value="Functional/business Traveller" selected>
                                                                        Functional/business Traveller</option>
                                                                } else {
                                                                    <option value="Functional/business Traveller">
                                                                        Functional/business Traveller</option>
                                                                }

                                                                @if(destination.getObject.getTravellerTypesList.contains("Holidaymaker")) {
                                                                    <option value="Holidaymaker" selected>Holidaymaker</option>
                                                                } else {
                                                                    <option value="Holidaymaker">Holidaymaker</option>
                                                                }
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="row">
                                                            <label>Make Public</label>
                                                        </div>
                                                        <div class="row">
                                                        @if(destination.getObject.getVisible == 1) {
                                                            <input type="checkbox" id="visible" name="visible" value="1" class="check-box" checked>
                                                        } else {
                                                            <input type="checkbox" id="visible" name="visible" value="1" class="check-box">
                                                            }
                                                        </div>
                                                    </div>
                                                </div>
                                        <div class="col">
                                        <div id="editMap"></div>
                                        </div>
                                        </div>
                                        </div>
                                            <!-- footer -->
                                        <div class="modal-footer">
                                            <a href="/destinations/show/@isPublic/@pagination.getOffset">
                                            <button type="button" class="btn btn-secondary">Close</button>
</a>
                                            <button type="submit" class="btn btn-primary" onclick="fillVals()">Save</button>
                                        </div>
                                    }
                                </div>
                            </div>
                            @if(destination.isEdit && destination.getObject != null) {
                                <script type="text/javascript">
                                        $(window).on('load', function () {
                                            $('#editModal').modal('show');
                                        });
                                </script>

                            }
                        </div>
                    }

                    <div class="modal fade" id="suggestEditModal">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h2 class="modal-title ">Suggest An Edit</h2>
                                </div>
                                <div class="modal-body">
                                    <div class="col">
                                        <div class="row justify-content-center">
                                            <div class="col-md-4">
                                                <b>To Remove</b>
                                            </div>
                                            <div class="col-md-4">
                                                <b>To Add</b>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div class="row justify-content-center">
                                            <div class="col-md-6">
                                                <div class="col " >
                                                    <select multiple="multiple" title="Traveller Type" id="toRemoveDropdown" data-width="100%">

                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <select multiple title="Traveller Type" id="toAddDropdown" data-width="100%">
                                                    <option value="ThrillSeeker">ThrillSeeker</option>
                                                    <option value="Backpacker">Backpacker</option>
                                                    <option value="Gap Year">Gap Year</option>
                                                    <option value="Groupie">Groupie</option>
                                                    <option value="Frequent Weekender">Frequent Weekender</option>
                                                    <option value="Functional/business Traveller">
                                                        Functional/business Traveller</option>
                                                    <option value="Holidaymaker">Holidaymaker</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                @helper.form(routes.DestinationsController.createEditRequest()) {
                                    @CSRF.formField
                                    <div class="hidden-div">
                                        <input type="text" id="toAdd" name="toAdd" class="hidden-field-2">
                                        <input type="text" id="toRemove" name="toRemove">
                                        <input type="number" id="destinationId" name="destinationId">
                                    </div>
                                    <button class="btn btn-outline-danger" data-dismiss="modal">Cancel</button>
                                    <button type="submit" class="btn btn-primary" onclick="fillDestReequestForm()">
                                        Submit Request</button>
                                }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal" id="confirmationDeleteModal">
                <div class="modal-dialog">
                    <div class="modal-content">
                            <!-- header -->
                        <div class="modal-header">
                            <h4 class="modal-title" id="#deleteTitle">Confirmation</h4>
                            <button type="button" class="close" data-dismiss="modal"></button>
                        </div>
                            <!-- body -->
                        <div class="modal-body">
                            <h5 id="#deleteBody">Are you sure you want to delete?</h5>
                        </div>
                            <!-- footer -->
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                            <a href="#" id="confirmDeleteHrf">
                                <button type="submit" id="confirmDeleteBtn" class="btn btn-danger">Delete</button>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </body>
    <script type="text/javascript">

            $('#startLinkSearch').on('click', function() {
               document.getElementById('startSearchHidden').click()
            })
            $('#prevLinkSearch').on('click', function() {
                document.getElementById('prevSearchHidden').click()
            })
            $('#nextLinkSearch').on('click', function() {
                document.getElementById('nextSearchHidden').click()
            });



            $(document).ready(function () {
                        $('#destTable').DataTable({
                            "sDom": 't'
                        });



                $('#startSearchHidden').hide();
                $('#prevSearchHidden').hide();
                $('#nextSearchHidden').hide();
                var next = document.getElementById('nextLink');
                var prev = document.getElementById('prevLink');
                var start = document.getElementById('startLink');
                document.getElementById('isPublic').value = "@isPublic";

                if (window.location.href.indexOf('search') == -1) {
                     if (next != null) {
                    next.href = '/destinations/show/@isPublic/@pagination.getNext';
                     }
                     if (prev != null) {
                    prev.href = '/destinations/show/@isPublic/@pagination.getPrevious';
                   }
                     if (start != null) {
                    start.href = '/destinations/show/@isPublic/0';

                     }


                }
                @if(searchVal != "") {
                document.getElementById('searchName').value = "@searchVal";
                }


                    });

            var map;
            var createMap;
            var editMap;
            var editMarker;
            var center;
            var createMarker;
            var createCenter;
            var markers = [];
            var markersMap = new Map();
            var destinationID;
            var selectedDestID;
            var nightStyle = [
                {
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#242f3e"
                        }
                    ]
                },
                {
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#746855"
                        }
                    ]
                },
                {
                    "elementType": "labels.text.stroke",
                    "stylers": [
                        {
                            "color": "#242f3e"
                        }
                    ]
                },
                {
                    "featureType": "administrative.locality",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#d59563"
                        }
                    ]
                },
                {
                    "featureType": "poi",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#d59563"
                        }
                    ]
                },
                {
                    "featureType": "poi.park",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#263c3f"
                        }
                    ]
                },
                {
                    "featureType": "poi.park",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#6b9a76"
                        }
                    ]
                },
                {
                    "featureType": "road",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#38414e"
                        }
                    ]
                },
                {
                    "featureType": "road",
                    "elementType": "geometry.stroke",
                    "stylers": [
                        {
                            "color": "#212a37"
                        }
                    ]
                },
                {
                    "featureType": "road",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#9ca5b3"
                        }
                    ]
                },
                {
                    "featureType": "road.highway",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#746855"
                        }
                    ]
                },
                {
                    "featureType": "road.highway",
                    "elementType": "geometry.stroke",
                    "stylers": [
                        {
                            "color": "#1f2835"
                        }
                    ]
                },
                {
                    "featureType": "road.highway",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#f3d19c"
                        }
                    ]
                },
                {
                    "featureType": "transit",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#2f3948"
                        }
                    ]
                },
                {
                    "featureType": "transit.station",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#d59563"
                        }
                    ]
                },
                {
                    "featureType": "water",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#17263c"
                        }
                    ]
                },
                {
                    "featureType": "water",
                    "elementType": "geometry.fill",
                    "stylers": [
                        {
                            "saturation": -10
                        }
                    ]
                },
                {
                    "featureType": "water",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#515c6d"
                        }
                    ]
                },
                {
                    "featureType": "water",
                    "elementType": "labels.text.stroke",
                    "stylers": [
                        {
                            "color": "#17263c"
                        }
                    ]
                }
            ];

            var dayStyle = [
                {
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#ebe3cd"
                        }
                    ]
                },
                {
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#523735"
                        }
                    ]
                },
                {
                    "elementType": "labels.text.stroke",
                    "stylers": [
                        {
                            "color": "#f5f1e6"
                        }
                    ]
                },
                {
                    "featureType": "administrative",
                    "elementType": "geometry.stroke",
                    "stylers": [
                        {
                            "color": "#c9b2a6"
                        }
                    ]
                },
                {
                    "featureType": "administrative.land_parcel",
                    "elementType": "geometry.stroke",
                    "stylers": [
                        {
                            "color": "#dcd2be"
                        }
                    ]
                },
                {
                    "featureType": "administrative.land_parcel",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#ae9e90"
                        }
                    ]
                },
                {
                    "featureType": "landscape.natural",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#dfd2ae"
                        }
                    ]
                },
                {
                    "featureType": "poi",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#dfd2ae"
                        }
                    ]
                },
                {
                    "featureType": "poi",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#93817c"
                        }
                    ]
                },
                {
                    "featureType": "poi.park",
                    "elementType": "geometry.fill",
                    "stylers": [
                        {
                            "color": "#a5b076"
                        }
                    ]
                },
                {
                    "featureType": "poi.park",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#447530"
                        }
                    ]
                },
                {
                    "featureType": "road",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#f5f1e6"
                        }
                    ]
                },
                {
                    "featureType": "road.arterial",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#fdfcf8"
                        }
                    ]
                },
                {
                    "featureType": "road.highway",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#f8c967"
                        }
                    ]
                },
                {
                    "featureType": "road.highway",
                    "elementType": "geometry.stroke",
                    "stylers": [
                        {
                            "color": "#e9bc62"
                        }
                    ]
                },
                {
                    "featureType": "road.highway.controlled_access",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#e98d58"
                        }
                    ]
                },
                {
                    "featureType": "road.highway.controlled_access",
                    "elementType": "geometry.stroke",
                    "stylers": [
                        {
                            "color": "#db8555"
                        }
                    ]
                },
                {
                    "featureType": "road.local",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#806b63"
                        }
                    ]
                },
                {
                    "featureType": "transit.line",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#dfd2ae"
                        }
                    ]
                },
                {
                    "featureType": "transit.line",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#8f7d77"
                        }
                    ]
                },
                {
                    "featureType": "transit.line",
                    "elementType": "labels.text.stroke",
                    "stylers": [
                        {
                            "color": "#ebe3cd"
                        }
                    ]
                },
                {
                    "featureType": "transit.station",
                    "elementType": "geometry",
                    "stylers": [
                        {
                            "color": "#dfd2ae"
                        }
                    ]
                },
                {
                    "featureType": "water",
                    "elementType": "geometry.fill",
                    "stylers": [
                        {
                            "color": "#b9d3c2"
                        },
                        {
                            "saturation": -10
                        }
                    ]
                },
                {
                    "featureType": "water",
                    "elementType": "labels.text.fill",
                    "stylers": [
                        {
                            "color": "#92998d"
                        }
                    ]
                }
            ];

            /**
             * Callback for success on geolocation to get users location
             */
            function setLocation(pos) {
                center = {lat: pos.coords.latitude, lng: pos.coords.longitude}
                var centerPos = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
                map.setCenter(centerPos);
                createMap.setCenter(centerPos);
                var currentPos = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
                addCreateMarker(currentPos);
                var youMarker = new google.maps.Marker({
                    map: map,
                    position: centerPos,
                    draggable: true
                });
                youMarker.content = "You Are Here";
                var infoWindow = new google.maps.InfoWindow();
                google.maps.event.addListener(youMarker, 'click', function () {
                    infoWindow.setContent(this.content);
                    infoWindow.open(map, this);
                });
            }


            /**
             * Initialises the map view
             */
            function initMap() {
                var styles;
                var today = new Date();
                var hours = today.getHours();
                if (hours <= 6 || hours >= 21) {
                    styles = nightStyle;
                } else {
                    styles = dayStyle;
                }


                if (center === undefined) {
                    center = {lat: 0, lng: 0};
                }
                map = new google.maps.Map(document.getElementById('destinationsMap'), {
                    center: center,
                    streetViewControl: false,
                    fullscreenControl: false,
                    zoom: 8,
                    styles: styles
                });

                createMap = new google.maps.Map(document.getElementById('createMap'), {
                    center: center,
                    streetViewControl: false,
                    fullscreenControl: false,
                    zoom: 8,
                    styles: styles
                });
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(setLocation);
                } else {
                    currentPos = new google.maps.LatLng(center.lat, center.lng);
                    addCreateMarker(currentPos);
                }



                @if(destination.isEdit && destination.getObject != null) {

                    var editCenter = {lat: @destination.getObject.getLatitude, lng:  @destination.getObject.getLongitude};
                    editMap = new google.maps.Map(document.getElementById('editMap'), {
                    center: editCenter,
                    streetViewControl: false,
                    fullscreenControl: false,
                    zoom: 8,
                    styles: styles
                });
                    editPos = new google.maps.LatLng(editCenter.lat, editCenter.lng);
                editMarker = new google.maps.Marker({
                    map: editMap,
                    position: editPos,
                    draggable: true
                });

                google.maps.event.addListener(editMarker, 'dragend', function(e) {
                    fillLatLngEdit(e.latLng.lat(), e.latLng.lng());
                });

                editMap.addListener('click', function(e) {
                    addEditMarker(e.latLng);
                });




            }

                if (navigator.geolocation) {

                    navigator.geolocation.getCurrentPosition(setLocation);
                }


                createMap.addListener('click', function(e) {
                    addCreateMarker(e.latLng);
                });

                addMarkers();
            }


            /**
            * Function to add a marker to the create destination map onclick
            */
            function addCreateMarker(pos) {
                if (createMarker) {
                    createMarker.setMap(null);
                }
                 createMarker = new google.maps.Marker({
                    map: createMap,
                    position: pos,
                    draggable: true
                });
                google.maps.event.addListener(createMarker, 'dragend', function(e) {
                    fillLatLng(e.latLng.lat(), e.latLng.lng());
                });
                fillLatLng(pos.lat(), pos.lng());

            }

            /**
            * Function to move marker when user changes lat/lng value from entry dialogs
            */
            function moveCreateMarker() {
                var pos = new google.maps.LatLng($('.createLat').val(), $('.createLng').val());
                if (createMarker) {
                    createMarker.setPosition(pos);
                } else {
                    createMarker = new google.maps.Marker({
                        map: createMap,
                        position: pos,
                        draggable: true
                    });
                }
                createMap.setCenter(pos);
            }


            /**
            * Function to fill fields with lat lng details from map
            */
            function fillLatLng(lat, lng) {
                $('.createLat').val(Number(Math.round(lat+'e'+10)+'e-'+10));
                $('.createLng').val(Number(Math.round(lng+'e'+10)+'e-'+10));
            }

            /**
            * Function to add a marker to the edit destination map onclick
            */
            function addEditMarker(pos) {
                if (editMarker) {
                    editMarker.setMap(null);
                }
                 editMarker = new google.maps.Marker({
                    map: editMap,
                    position: pos,
                    draggable: true
                });
                google.maps.event.addListener(editMarker, 'dragend', function(e) {
                    fillLatLngEdit(e.latLng.lat(), e.latLng.lng());
                });
                fillLatLngEdit(pos.lat(), pos.lng());

            }

            /**
            * Function to move marker when user changes lat/lng value from entry dialogs during edit
            */
            function moveEditMarker() {
                var pos = new google.maps.LatLng($('.editLat').val(), $('.editLng').val());
                if (editMarker) {
                    editMarker.setPosition(pos);
                } else {
                    editMarker = new google.maps.Marker({
                        map: editMap,
                        position: pos,
                        draggable: true
                    });
                }
                editMap.setCenter(pos);
            }


            /**
            * Function to fill fields with lat lng details from map dureing edit
            */
            function fillLatLngEdit(lat, lng) {
                //-43.5221018792
                //  0.0000000000
                $('.editLat').val(Number(Math.round(lat+'e'+10)+'e-'+10));
                $('.editLng').val(Number(Math.round(lng+'e'+10)+'e-'+10));
            }


            /**
             * Adds all current destinations to the map as markers
             */
            function addMarkers() {


                @for(destination <- destinationsList) {
                var icon;
                if (@destination.getVisible ===
                1
            )
                {
                    icon = 'http://maps.gstatic.com/mapfiles/ridefinder-images/mm_20_green.png';
                }
            else
                {
                    icon = 'http://maps.gstatic.com/mapfiles/ridefinder-images/mm_20_red.png';
                }
                var marker = new google.maps.Marker({
                    position: {
                        lat: @destination.getLatitude,
                        lng: @destination.getLongitude
                    },
                    animation: google.maps.Animation.DROP,
                    map: map,
                    icon: icon
                });

                marker.content = "Name: @destination.getName" +
                        "<br> Type: @destination.getType" +
                        "<br> Country: @destination.getCountry";
                var destinationId = @destination.getDestinationId;
                var infoWindow = new google.maps.InfoWindow();
                google.maps.event.addListener(marker, 'click', function () {
                    infoWindow.setContent(this.content);
                    infoWindow.open(this.getMap(), this);
                    document.getElementById("nameVal").innerHTML = " <b>Name: &nbsp;&nbsp;</b> @destination.getName";
                    document.getElementById("typeVal").innerHTML = "  <b>Type: &nbsp;&nbsp;</b> @destination.getType";
                    document.getElementById("countryVal").innerHTML = "  <b>Country: &nbsp;&nbsp;</b> @destination.getCountry";
                    document.getElementById("districtVal").innerHTML = "  <b>District: &nbsp;&nbsp;</b> @destination.getDistrict";
                    document.getElementById("latVal").innerHTML = "  <b>Latitude: &nbsp;&nbsp;</b> @destination.getLatitude";
                    document.getElementById("lngVal").innerHTML = "  <b>Longitude: &nbsp;&nbsp;</b> @destination.getLongitude";
                    document.getElementById("travellerTypesVal").innerHTML = "  <b>Traveller Types: &nbsp;&nbsp;</b> @destination.getTravellerTypesString";
                    @if(destination.getVisible == 1){
                    document.getElementById("suggestEditButton").hidden = false;
                    document.getElementById("publicVal").innerHTML = "  <b>Visibility: &nbsp;&nbsp;</b> Public ";
                    }else{
                    document.getElementById("suggestEditButton").hidden = true;
                    document.getElementById("publicVal").innerHTML = "  <b>Visibily: &nbsp;&nbsp;</b> Private ";
                    }

                    document.getElementById("userPhotos").innerHTML = " ";
                    document.getElementById("photoUpdate").innerHTML = " ";
                    document.getElementById("worldPhotos").innerHTML = " ";

                    // document.getElementById("userPhotos").innerHTML = "";
                    @for(photo <- usersPhotos){
                    @if(destination.getUsersPhotos.contains(photo)){
                    document.getElementById("userPhotos").innerHTML +=
                            "                            <div class=\"card\" id=\"imageCard\">\n" +
                            "                            <img onclick=\"expand(src, alt, name)\" id=\"displayImage\" class=\"thumbnail\"\n" +
                            "                            src=\"@routes.ProfileController.photoAt(photo.getPhotoId)\" alt=\"@photo.getName\"\n" +
                            "                            name=\"@photo.getPhotoId\">\n" +
                            "                            <div id=\"photosCaption\">@if(photo.getVisible == 1) {\n" +
                            "                                            <p class=\"card-text\"> @photo.displayVisibility(photo.getVisible) </p>\n" +
                            "                                            <a href=\"@routes.DestinationsController.updatePhotoPrivacy(photo.getPhotoId)\">\n" +
                            "                                                <button class=\"btn btn-outline-primary\">Make Private</button></a>\n" +
                            "                                        } else {\n" +
                            "                                            <p class=\"card-text\"> @photo.displayVisibility(photo.getVisible) </p>\n" +
                            "                                            <a href=\"@routes.DestinationsController.updatePhotoPrivacy(photo.getPhotoId)\">\n" +
                            "                                                <button class=\"btn btn-outline-primary\">Make Public</button></a>\n" +
                            "                                        }\n" +
                            "                            <input type=\"hidden\" id=\"photoId\" name=\"photoId\" value=\"@photo.getPhotoId\">\n" +
                            "                            <a id=\"addPhoto\" href=\"@routes.DestinationsController.unlinkPhotoFromDestination(photo.getPhotoId, destination.getDestinationId)\">\n" +
                            "                            <button class=\"btn btn-outline-secondary\" type=\"submit\">Unlink</button>\n" +
                            "                            </a>\ </div>" +
                            "                            <!-- The Expanded Photo Modal -->\n" +
                            "                            <div id=\"expandImageModal\" class=\"modal\">\n" +
                            "                            <span class=\"close\">&times;</span>\n" +
                            "                            <img class=\"modal-content\" id=\"expandedImage\">\n" +
                            "                            <div id=\"caption\"></div>\n" +
                            "                            <div id=\"id\"></div>\n" +
                            "                            </div>\n" +
                            "                            </div>";
                    }
                    }
                    @for(photo <- usersPhotos) {
                    @if(!destination.getUsersPhotos.contains(photo)) {
                    document.getElementById("photoUpdate").innerHTML +=
                            "                            <div class=\"card\" id=\"imageCard\">\n" +
                            "                            <img id=\"displayImage\" class=\"thumbnail\"\n" +
                            "                            src=\"@routes.ProfileController.photoAt(photo.getPhotoId)\" alt=\"@photo.getName\"\n" +
                            "                            name=\"@photo.getPhotoId\">\n" +
                            "                            <div class=\"card-body\" id=\"photoUpdate\">\n" +
                            "                            <input type=\"hidden\" id=\"photoId\" name=\"photoId\" value=\"@photo.getPhotoId\">\n" +
                            "                            <a id=\"addPhoto\" href=\"@routes.DestinationsController.linkPhotoToDestination(photo.getPhotoId, destination.getDestinationId)\">\n" +
                            "                            <button class=\"btn btn-primary\" type=\"submit\">Link</button>\n" +
                            "                            </a>\n" +
                            "                            </div>";
                    }
                    }
                    @for(photo <- destination.getWorldPhotos){
                    @if(photo.getVisible == 1) {
                    document.getElementById("worldPhotos").innerHTML +=
                            "                            <div class=\"card\">\n" +
                            "                            <img onclick=\"expand(src, alt, name)\" id=\"displayImage\" class=\"thumbnail\"\n" +
                            "                            src=\"@routes.ProfileController.photoAt(photo.getPhotoId)\" alt=\"@photo.getName\"\n" +
                            "                            name=\"@photo.getPhotoId\">\n" +
                            "                            <!-- The Expanded Photo Modal -->\n" +
                            "                            <div id=\"expandImageModal\" class=\"modal\">\n" +
                            "                            <span class=\"close\">&times;</span>\n" +
                            "                            <img class=\"modal-content\" id=\"expandedImage\">\n" +
                            "                            <div id=\"caption\"></div>\n" +
                            "                            <div id=\"id\"></div>\n" +
                            "                            </div>\n" +
                            "                            </div>";
                    }
                    }
                });


                markers.push(marker);
                markersMap.set(@destination.getDestinationId, marker);
                }
                var legend = document.getElementById('legend');
                var publicDiv = document.createElement('div');
                publicDiv.innerHTML = '<img src="http://maps.gstatic.com/mapfiles/ridefinder-images/mm_20_green.png"> Public Destination';
                var privateDiv = document.createElement('div');
                privateDiv.innerHTML = '<img src="http://maps.gstatic.com/mapfiles/ridefinder-images/mm_20_red.png"> Private Destination';
                legend.appendChild(publicDiv);
                legend.appendChild(privateDiv);
                map.controls[google.maps.ControlPosition.RIGHT_TOP].push(legend);
            }


            /**
             * Onclick of a table row sets the center of the map to that destination
             * and makes the related marker bounce
             */
            function setSelectedDestination(destinationId, row) {
                selectedDestID = destinationId;
                var markerToSet = markersMap.get(destinationId);

                new google.maps.event.trigger(markerToSet, 'click');
                map.setCenter(markerToSet.getPosition());
                clearAnimations();
                markerToSet.setAnimation(google.maps.Animation.BOUNCE);
                setTimeout(function () {
                    markerToSet.setAnimation(null)
                }, 3000);
                clearRows();
                if (row.style.backgroundColor === "") {
                    row.style.backgroundColor = "#A9A9A9";
                } else {
                    row.style.backgroundColor = "";
                }

            }

            /**
             * Stops all marker animations on the map
             */
            function clearAnimations() {
                for (var i = 0; i < markers.length; i++) {
                    markers[i].setAnimation(null);
                }
            }

            /**
             * Sets all rows in the table back to the default background colour
             */
            function clearRows() {
                var rows = document.getElementById("destTable").rows;
                for (var i = 1; i < rows.length; i++) {
                    rows[i].style.backgroundColor = "";
                }
            }

            function getSelectedDestID() {
                return selectedDestID;
            }

            function fillVals() {
                $('#travellerTypesStringDest').val($('#typeDropdown').val());
                $('#travellerTypesForm').val($('#typeDropdownEdit').val());
                $('#country').val($('#countriesDropdown').val());
                $('#countryEdit').val($('#countriesDropdownEdit').val());
            }

            function fillDestReequestForm() {
                document.getElementById("toAdd").value = $('#toAddDropdown').val();
                document.getElementById("toRemove").value = $('#toRemoveDropdown').val();
            }

            function setTravellerTypesToRemove() {
                var html = "";
                resetTypesDropdowns();
                @for(destination <- destinationsList) {
                var id = @destination.getDestinationId;
                if (id === getSelectedDestID()) {
                    var len = @destination.getTravellerTypesList.size();
                    @for(travellerType <- destination.getTravellerTypesList) {
                    var select = document.getElementById("toRemoveDropdown");
                    var selectAdd = document.getElementById("toAddDropdown");
                    var option = document.createElement("option");
                    option.text = "@travellerType";
                    option.value = "@travellerType";
                    selectAdd.remove(option);
                    select.add(option);
                    }
                    document.getElementById("destinationId").value = @destination.getDestinationId();
                }
                }
            }

            // Method that gets the photo data from on the photo clicked and displays
            // it in its original resolution in a new modal
            function expand(photo, text, id) {
                // Get the modal
                var modal = document.getElementById('expandImageModal');
                var modalImg = document.getElementById('expandedImage');
                var captionText = document.getElementById("caption");

                modal.style.display = "block";
                modalImg.src = photo;
                captionText.innerHTML = text;

                // Get the <span> element that closes the modal
                var span = document.getElementsByClassName("close")[0];

                // When the user clicks on <span> (x), close the modal
                span.onclick = function () {
                    modal.style.display = "none";
                }
            }

            function fillDeleteValues(route) {
                var a = document.getElementById("confirmDeleteHrf");
                a.href = route;
                a.method = "POST";
                $('#confirmationDeleteModal').modal('show');
            }


            // ------------- SIDEBAR TOGGLE JS -------------
            $(function () {
                $(".toggleButton").on('click', function (e) {
                    $("#wrapper").toggleClass('toggled');

                    e.stopPropagation();
                    return false;
                });

                $('*:not(.toggleButton)').on('click', function () {
                    $("#wrapper").addClass('toggled');
                });

            });

            // ---------------------------------------------


            function resetTypesDropdowns() {
                var i;
                for (i = document.getElementById("toAddDropdown").options.length - 1 ; i >= 0 ; i--) {
                    document.getElementById("toAddDropdown").remove(i);
                }
                i = 0;
                for (i = document.getElementById("toRemoveDropdown").options.length - 1 ; i >= 0 ; i--) {
                    document.getElementById("toRemoveDropdown").remove(i);
                }
                var selectAdd = document.getElementById("toAddDropdown");
                selectAdd.add(new Option("Backpacker", "Backpacker"));
                selectAdd.add(new Option("ThrillSeeker", "ThrillSeeker"));
                selectAdd.add(new Option("Holidaymaker", "Holidaymaker"));
                selectAdd.add(new Option("Frequent Weekender", "Frequent Weekender"));
                selectAdd.add(new Option("Groupie", "Groupie"));
                selectAdd.add(new Option("Gap Year", "Gap Year"));
                selectAdd.add(new Option("Functional/business Traveller", "Functional/business Traveller"));
            }

            function togglePublic() {
                @if(searchVal != "") {
                    if (document.getElementById('destToggle').checked == false) {
                        document.getElementById('is1Public').checked = false;
                        document.getElementById('is1Public').value = false;
                        document.getElementById('searchButton').click()
                    } else {
                        document.getElementById('is1Public').checked = true;
                        document.getElementById('is1Public').value = true;
                        document.getElementById('searchButton').click()
                    }
                } else {
                    if (document.getElementById('destToggle').checked == false) {
                        location.replace("@routes.DestinationsController.show(false, 0)");
                    }
                    else {
                        location.replace("@routes.DestinationsController.show(true, 0)");
                    }
                }
            }
    </script>

    @*<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC9Z1g5p2rQtS0nHgDudzCCXVl2HJl3NPI&callback=initMap"*@
    @*async defer></script>*@
    <script src="https://maps.googleapis.com/maps/api/js?callback=initMap"
    async defer></script>

</html>
